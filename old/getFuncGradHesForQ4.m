function [dist_func,grad_func,hess_func]=getFuncGradHesForQ4(x,y,z,pt_q,nat)
        %DISTFUNC
        %    DIST_FUNC = DISTFUNC(IN1,IN2,IN3,IN4,IN5)

        %    This function was generated by the Symbolic Math Toolbox version 8.3.
        %    06-Jan-2022 12:56:24

        P_q1 = pt_q(1,:);
        P_q2 = pt_q(2,:);
        P_q3 = pt_q(3,:);
        eta = nat(2,:);
        x1 = x(1,:);
        x2 = x(2,:);
        x3 = x(3,:);
        x4 = x(4,:);
        xsi = nat(1,:);
        y1 = y(1,:);
        y2 = y(2,:);
        y3 = y(3,:);
        y4 = y(4,:);
        z1 = z(1,:);
        z2 = z(2,:);
        z3 = z(3,:);
        z4 = z(4,:);
        t2 = eta+1.0;
        t3 = eta-1.0;
        t4 = xsi./4.0;
        t5 = t4+1.0./4.0;
        t6 = t4-1.0./4.0;
        dist_func = sqrt(abs(P_q1-t2.*t5.*x3+t3.*t5.*x2-t3.*t6.*x1+t2.*t6.*x4).^2+abs(P_q2-t2.*t5.*y3+t3.*t5.*y2-t3.*t6.*y1+t2.*t6.*y4).^2+abs(P_q3-t2.*t5.*z3+t3.*t5.*z2-t3.*t6.*z1+t2.*t6.*z4).^2);

        P_q1 = pt_q(1,:);
        P_q2 = pt_q(2,:);
        P_q3 = pt_q(3,:);
        eta = nat(2,:);
        x1 = x(1,:);
        x2 = x(2,:);
        x3 = x(3,:);
        x4 = x(4,:);
        xsi = nat(1,:);
        y1 = y(1,:);
        y2 = y(2,:);
        y3 = y(3,:);
        y4 = y(4,:);
        z1 = z(1,:);
        z2 = z(2,:);
        z3 = z(3,:);
        z4 = z(4,:);
        t2 = eta+1.0;
        t3 = eta-1.0;
        t4 = xsi./4.0;
        t5 = t4+1.0./4.0;
        t6 = t4-1.0./4.0;
        t7 = t2.*t5.*x3;
        t8 = t2.*t5.*y3;
        t9 = t2.*t5.*z3;
        t10 = t3.*t5.*x2;
        t11 = t2.*t6.*x4;
        t12 = t3.*t5.*y2;
        t13 = t2.*t6.*y4;
        t14 = t3.*t5.*z2;
        t15 = t2.*t6.*z4;
        t16 = t3.*t6.*x1;
        t18 = t3.*t6.*y1;
        t20 = t3.*t6.*z1;
        t17 = -t7;
        t19 = -t8;
        t21 = -t9;
        t22 = -t16;
        t23 = -t18;
        t24 = -t20;
        t25 = P_q2+t12+t13+t19+t23;
        t26 = P_q3+t14+t15+t21+t24;
        t27 = P_q1+t10+t11+t17+t22;
        t28 = abs(t27);
        t29 = abs(t25);
        t30 = abs(t26);
        t31 = sign(t27);
        t32 = sign(t25);
        t33 = sign(t26);
        t34 = t28.^2;
        t35 = t29.^2;
        t36 = t30.^2;
        t37 = t34+t35+t36;
        t38 = 1.0./sqrt(t37);
        grad_func = [t38.*(t28.*t31.*((t3.*x1)./4.0+(t2.*x3)./4.0-(t3.*x2)./4.0-(t2.*x4)./4.0).*2.0+t29.*t32.*((t3.*y1)./4.0+(t2.*y3)./4.0-(t3.*y2)./4.0-(t2.*y4)./4.0).*2.0+t30.*t33.*((t3.*z1)./4.0+(t2.*z3)./4.0-(t3.*z2)./4.0-(t2.*z4)./4.0).*2.0).*(-1.0./2.0),(t38.*(t28.*t31.*(t5.*x2-t6.*x1-t5.*x3+t6.*x4).*2.0+t29.*t32.*(t5.*y2-t6.*y1-t5.*y3+t6.*y4).*2.0+t30.*t33.*(t5.*z2-t6.*z1-t5.*z3+t6.*z4).*2.0))./2.0];

        P_q1 = pt_q(1,:);
        P_q2 = pt_q(2,:);
        P_q3 = pt_q(3,:);
        eta = nat(2,:);
        x1 = x(1,:);
        x2 = x(2,:);
        x3 = x(3,:);
        x4 = x(4,:);
        xsi = nat(1,:);
        y1 = y(1,:);
        y2 = y(2,:);
        y3 = y(3,:);
        y4 = y(4,:);
        z1 = z(1,:);
        z2 = z(2,:);
        z3 = z(3,:);
        z4 = z(4,:);
        t2 = eta+1.0;
        t3 = eta-1.0;
        t4 = x1./4.0;
        t5 = x2./4.0;
        t6 = x3./4.0;
        t7 = x4./4.0;
        t8 = xsi./4.0;
        t9 = y1./4.0;
        t10 = y2./4.0;
        t11 = y3./4.0;
        t12 = y4./4.0;
        t13 = z1./4.0;
        t14 = z2./4.0;
        t15 = z3./4.0;
        t16 = z4./4.0;
        t17 = -t5;
        t18 = -t7;
        t19 = -t10;
        t20 = -t12;
        t21 = -t14;
        t22 = -t16;
        t23 = t2.*t6;
        t24 = t2.*t7;
        t25 = t2.*t11;
        t26 = t2.*t12;
        t27 = t2.*t15;
        t28 = t2.*t16;
        t29 = t8+1.0./4.0;
        t30 = t3.*t4;
        t31 = t3.*t5;
        t32 = t2.*x4.*(-1.0./4.0);
        t33 = t3.*t9;
        t34 = t3.*t10;
        t35 = t2.*y4.*(-1.0./4.0);
        t36 = t3.*t13;
        t37 = t3.*t14;
        t38 = t2.*z4.*(-1.0./4.0);
        t39 = t8-1.0./4.0;
        t40 = t3.*x2.*(-1.0./4.0);
        t41 = t3.*y2.*(-1.0./4.0);
        t42 = t3.*z2.*(-1.0./4.0);
        t43 = t29.*x2;
        t44 = t29.*x3;
        t45 = t29.*y2;
        t46 = t29.*y3;
        t47 = t29.*z2;
        t48 = t29.*z3;
        t49 = t39.*x1;
        t50 = t39.*x4;
        t51 = t39.*y1;
        t52 = t39.*y4;
        t53 = t39.*z1;
        t54 = t39.*z4;
        t79 = t4+t6+t17+t18;
        t80 = t9+t11+t19+t20;
        t81 = t13+t15+t21+t22;
        t82 = t23+t30+t32+t40;
        t83 = t25+t33+t35+t41;
        t84 = t27+t36+t38+t42;
        t55 = -t43;
        t56 = -t45;
        t57 = -t47;
        t58 = -t50;
        t59 = -t52;
        t60 = -t54;
        t61 = t2.*t44;
        t62 = t2.*t46;
        t63 = t2.*t48;
        t64 = t3.*t43;
        t65 = t2.*t50;
        t66 = t3.*t45;
        t67 = t2.*t52;
        t68 = t3.*t47;
        t69 = t2.*t54;
        t70 = t3.*t49;
        t72 = t3.*t51;
        t74 = t3.*t53;
        t85 = t82.^2;
        t86 = t83.^2;
        t87 = t84.^2;
        t91 = (t47-t48-t53+t54).^2;
        t92 = (t43-t44-t49+t50).^2;
        t93 = (t45-t46-t51+t52).^2;
        t71 = -t61;
        t73 = -t62;
        t75 = -t63;
        t76 = -t70;
        t77 = -t72;
        t78 = -t74;
        t88 = t44+t49+t55+t58;
        t89 = t46+t51+t56+t59;
        t90 = t48+t53+t57+t60;
        t94 = P_q2+t66+t67+t73+t77;
        t95 = P_q3+t68+t69+t75+t78;
        t96 = P_q1+t64+t65+t71+t76;
        t97 = abs(t96);
        t98 = dirac(t96);
        t99 = abs(t94);
        t100 = dirac(t94);
        t101 = abs(t95);
        t102 = dirac(t95);
        t103 = sign(t96);
        t104 = sign(t94);
        t105 = sign(t95);
        t106 = t97.^2;
        t107 = t99.^2;
        t108 = t101.^2;
        t109 = t103.^2;
        t110 = t104.^2;
        t111 = t105.^2;
        t112 = t81.*t101.*t105.*2.0;
        t116 = t79.*t97.*t103.*2.0;
        t117 = t80.*t99.*t104.*2.0;
        t121 = t82.*t97.*t103.*2.0;
        t122 = t83.*t99.*t104.*2.0;
        t123 = t84.*t101.*t105.*2.0;
        t124 = t97.*t103.*(t43-t44-t49+t50).*-2.0;
        t125 = t99.*t104.*(t45-t46-t51+t52).*-2.0;
        t126 = t101.*t105.*(t47-t48-t53+t54).*-2.0;
        t130 = t82.*t97.*t98.*(t43-t44-t49+t50).*-4.0;
        t131 = t83.*t99.*t100.*(t45-t46-t51+t52).*-4.0;
        t132 = t84.*t101.*t102.*(t47-t48-t53+t54).*-4.0;
        t113 = t82.*t109.*(t43-t44-t49+t50).*-2.0;
        t114 = t83.*t110.*(t45-t46-t51+t52).*-2.0;
        t115 = t84.*t111.*(t47-t48-t53+t54).*-2.0;
        t118 = -t112;
        t119 = -t116;
        t120 = -t117;
        t127 = t106+t107+t108;
        t133 = t121+t122+t123;
        t134 = t124+t125+t126;
        t128 = 1.0./sqrt(t127);
        t137 = t113+t114+t115+t118+t119+t120+t130+t131+t132;
        t129 = t128.^3;
        t138 = t128.*(t112+t116+t117+t82.*t109.*(t43-t44-t49+t50).*2.0+t83.*t110.*(t45-t46-t51+t52).*2.0+t84.*t111.*(t47-t48-t53+t54).*2.0+t82.*t97.*t98.*(t43-t44-t49+t50).*4.0+t83.*t99.*t100.*(t45-t46-t51+t52).*4.0+t84.*t101.*t102.*(t47-t48-t53+t54).*4.0).*(-1.0./2.0);
        t135 = t129.*t133.*(t97.*t103.*(t43-t44-t49+t50).*2.0+t99.*t104.*(t45-t46-t51+t52).*2.0+t101.*t105.*(t47-t48-t53+t54).*2.0).*(-1.0./4.0);
        t136 = (t129.*t133.*(t97.*t103.*(t43-t44-t49+t50).*2.0+t99.*t104.*(t45-t46-t51+t52).*2.0+t101.*t105.*(t47-t48-t53+t54).*2.0))./4.0;
        t139 = t136+t138;
        hess_func = reshape([(t128.*(t85.*t109.*2.0+t86.*t110.*2.0+t87.*t111.*2.0+t85.*t97.*t98.*4.0+t86.*t99.*t100.*4.0+t87.*t101.*t102.*4.0))./2.0-(t129.*t133.^2)./4.0,t139,t139,t129.*(t97.*t103.*(t43-t44-t49+t50).*2.0+t99.*t104.*(t45-t46-t51+t52).*2.0+t101.*t105.*(t47-t48-t53+t54).*2.0).^2.*(-1.0./4.0)+(t128.*(t92.*t109.*2.0+t91.*t111.*2.0+t93.*t110.*2.0+t92.*t97.*t98.*4.0+t93.*t99.*t100.*4.0+t91.*t101.*t102.*4.0))./2.0],[2,2]);
end